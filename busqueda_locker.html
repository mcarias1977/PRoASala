<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="busqueda.css">
    <title>Inventario de Laboratorio</title>
</head>
<body>
    <!-- Header -->
    <header> 
        <div class="circle">
            <img src="recursos\logo.png" alt="logo">
        </div>
        <div class="container">
            <h1>INVENTARIO DE LABORATORIO</h1>
            <h2>Escuela ProA</h2>
        </div>
    </header>

    <!-- Contenido Principal -->
    <main class="main-content">
        <!-- Tres botones principales -->
        <div class="botones-grid">
            <a class="boton-card" href="busqueda.html">
                <div class="icono-contenedor buscar-elemento">
                    <svg fill="none" stroke="white" stroke-width="3" viewBox="0 0 24 24">
                        <circle cx="11" cy="11" r="8"/>
                        <path d="m21 21-4.35-4.35"/>
                    </svg>
                </div>
                <p>BUSCAR<br>ELEMENTO</p>
            </a>

            <a class="boton-card" href="busqueda_locker.html">
                <div class="icono-contenedor buscar-locker">
                    <svg fill="none" stroke="white" stroke-width="2" viewBox="0 0 24 24">
                        <rect x="5" y="11" width="14" height="10" rx="2"/>
                        <circle cx="12" cy="16" r="1" fill="white"/>
                        <path d="M8 11V7a4 4 0 0 1 8 0v4"/>
                    </svg>
                </div>
                <p>BUSCAR POR<br>LOCKER</p>
            </a>

            <div class="boton-card">
                <div class="icono-contenedor admin">
                    <svg fill="none" stroke="white" stroke-width="2" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M12 1v6m0 6v6M3 12h6m6 0h6"/>
                        <path d="m16.24 7.76 4.24-4.24m-4.24 16.96 4.24 4.24M7.76 7.76 3.52 3.52m4.24 16.96L3.52 20.48"/>
                    </svg>
                </div>
                <p>ADMIN</p>
            </div>
        </div>

        <!-- Buscador -->
        <div class="buscador">
            <input type="text" placeholder="Buscar Elemento...">
            <svg fill="none" stroke="#2ba1d8" stroke-width="3" viewBox="0 0 24 24">
                <circle cx="11" cy="11" r="8"/>
                <path d="m21 21-4.35-4.35"/>
            </svg>
        </div>

            <!-- Dropdown de categorías -->
    <div class="categoria-dropdown" id="categoriaDropdown">
        <span id="categoriaSeleccionada">Todas las Categorías</span>
        <svg fill="#2ba1d8" viewBox="0 0 24 24">
            <path d="M7 10l5 5 5-5z"/>
        </svg>
    </div>

    <ul class="lista-categorias" id="listaCategorias">
        <li data-categoria="Todas las Categorías">Todas las Categorías</li>
        <li data-categoria="Vidriería">Vidriería</li>
        <li data-categoria="Reactivos químicos">Reactivos químicos</li>
        <li data-categoria="Instrumentos de medición">Instrumentos de medición</li>
        <li data-categoria="Material eléctrico / electrónico">Material eléctrico / electrónico</li>
        <li data-categoria="Material de seguridad">Material de seguridad</li>
        <li data-categoria="Material descartable">Material descartable</li>
        <li data-categoria="Materiales biológicos">Materiales biológicos</li>
        <li data-categoria="Herramientas y soportes">Herramientas y soportes</li>
    </ul>

        <!-- Lista de elementos (se genera dinámicamente) -->
        <div class="lista-elementos">
            <!-- Los elementos se cargarán automáticamente desde el Excel -->
        </div>
    </main>

    <!-- Librería XLSX -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- Tu JavaScript -->
    <script src="busqueda.js"></script>
    <!-- Ajustes: Página dedicada a búsqueda por locker -->
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        // Reemplaza el input para eliminar listeners anteriores y forzar búsqueda por locker
        const oldInput = document.querySelector('.buscador input');
        if (!oldInput) return;

        const newInput = oldInput.cloneNode(true);
        newInput.placeholder = 'Buscar por número de locker...';
        // Reemplaza el elemento en el DOM (esto elimina listeners agregados por busqueda.js)
        oldInput.parentNode.replaceChild(newInput, oldInput);

        // Ocultar el dropdown de categorías en esta página (no hay filtro de categoría)
        const catDropdown = document.getElementById('categoriaDropdown');
        if (catDropdown) catDropdown.style.display = 'none';
        const listaCategorias = document.getElementById('listaCategorias');
        if (listaCategorias) listaCategorias.style.display = 'none';

        // Mostrar mensaje inicial: no mostrar elementos hasta que se ingrese un locker
        const contenedor = document.querySelector('.lista-elementos');
        if (contenedor) {
            contenedor.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">Ingrese número de locker para ver resultados</p>';
        }
        // Asegurar que inventarioFiltrado esté vacío inicialmente
        if (typeof inventarioFiltrado !== 'undefined') inventarioFiltrado = [];

        // Función de filtrado: solo por locker. No muestra todo cuando el input está vacío.
        function filtrarPorLocker() {
            const texto = newInput.value.toLowerCase().trim();
            if (texto === '') {
                inventarioFiltrado = [];
            } else {
                inventarioFiltrado = inventarioCompleto.filter(item => {
                    return item.locker && item.locker.toString().toLowerCase().includes(texto);
                });
            }
            // Si no hay resultados y el input no está vacío, mostrar el mensaje por defecto de mostrarTarjetas
            if (contenedor && texto === '' ) {
                contenedor.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">Ingrese número de locker para ver resultados</p>';
            } else {
                mostrarTarjetas();
            }
        }

        // Escuchar cambios en el input
        newInput.addEventListener('input', filtrarPorLocker);

        // No filtrar automáticamente si el input está vacío; si viene con valor, ejecutar filtrado
        if (newInput.value && newInput.value.trim() !== '') filtrarPorLocker();

        // Marcar visualmente el botón locker como activo y pintar los demás en gris
        const lockerIcon = document.querySelector('.buscar-locker');
        const lockerCard = lockerIcon ? lockerIcon.parentElement : null;
        const botonCards = document.querySelectorAll('.boton-card');
        botonCards.forEach(bc => {
            const icon = bc.querySelector('.icono-contenedor');
            const text = bc.querySelector('p');
            if (bc === lockerCard) {
                bc.classList.add('active');
                if (icon) icon.style.backgroundColor = '#2ba1d8';
                if (text) text.style.color = '#000';
            } else {
                bc.classList.remove('active');
                if (icon) icon.style.backgroundColor = '#8a9589';
                if (text) text.style.color = '#000';
            }
        });
    });
    </script>
</body>
</html>